import{i as S,j as fe,d as me,g as d,k as E,l as N,c as I,b as l,w as a,m as q,u as o,a as U,F as P,r as Y,o as k,n as x,p as O,q as $,s as G,v as H,x as b,f as p,y as J,z as L,t as C,A as ve,B as ye,C as K}from"./index-DGXskys5.js";const be=(_,c)=>({toDoListSearch:async s=>{const u=_+c+"/vue3API/toDoListAPI/search",r={parameter:s};return await S.post(u,r)},toDoListModify:async s=>{const u=_+c+"/vue3API/toDoListAPI/modify",r={parameter:s};return await S.put(u,r)},toDoListDelete:async s=>{const u=_+c+"/vue3API/toDoListAPI/delete",r={parameter:s};return await S.delete(u,{data:r})},toDoListInsert:async s=>{const u=_+c+"/vue3API/toDoListAPI/insert",r={parameter:s};return await S.post(u,r)}}),_e="http://localhost:5678/",ge="myback",we=be(_e,ge),w=(_,c)=>{fe[_]({message:c,position:"bottom-right"})},xe={class:"w-full flex flex-justify-center mt-2"},Ve=me({__name:"toDoList",setup(_){const{toDoListSearch:c,toDoListInsert:z,toDoListModify:R,toDoListDelete:M}=we,D=d(!1),m=d(!1),s=d(""),u=d(!1),r=d(""),A=d(""),Q=E(()=>r.value==="刪除"?"danger":"primary"),W=d(),f=N({list_name:"",done_yn:"",description:""}),T=d(),i=N({list_name:"",done_yn:"",description:""}),X=d({list_name:[{required:!0,message:"此欄位必填"}]}),g=d([]),B=d(10),Z=E(()=>g.value.length),F=d(1),ee=E(()=>g.value.slice(B.value*(F.value-1),B.value*F.value)),h=d([{label:"已完成",value:"Y"},{label:"未完成",value:"N"}]),te=async()=>{let n={list_name:f.list_name,description:f.description,done_yn:f.done_yn};D.value=!0,await c(n).then(async e=>{g.value=[...e.data]}),D.value=!1},le=async()=>{for(const n in i)i[n]="";s.value="新增",m.value=!0},ae=async n=>{s.value="編輯";for(const e in n.row)i[e]=n.row[e];m.value=!0},oe=async n=>{s.value="刪除",r.value="刪除";for(const e in n.row)i[e]=n.row[e];u.value=!0},ne=async()=>{m.value=!1},se=async()=>{T.value.validate((n,e)=>{var v;if(console.log(e),n)s.value==="新增"?(r.value="確定新增",A.value="確定新增該筆資料嗎?"):(r.value="確定編輯",A.value="確定編輯該筆資料嗎?"),u.value=!0;else switch((v=e.list_name[0])==null?void 0:v.field){case"list_name":w("warning","待辦事項欄位為必填");break}})},ue=async()=>{u.value=!1},re=async()=>{let n={};for(const e in i)n[e]=i[e];D.value=!0,s.value==="新增"?await z(n).then(async()=>{await c({list_name:"",description:"",done_yn:""}).then(e=>{g.value=[...e.data],w("success","新增成功"),m.value=!1})}).catch(e=>{w("error","新增失敗"+e)}):s.value==="編輯"?await R(n).then(async()=>{await c({list_name:"",description:"",done_yn:""}).then(e=>{g.value=[...e.data],w("success","編輯成功"),m.value=!1})}).catch(e=>{w("error","編輯失敗"+e)}):r.value==="刪除"&&await M(n).then(async()=>{await c({list_name:"",description:"",done_yn:""}).then(e=>{g.value=[...e.data],w("success","刪除成功"),m.value=!1})}).catch(e=>{w("error","刪除失敗"+e)}),D.value=!1,u.value=!1},ie=({prop:n,order:e})=>{g.value.sort(de(n,e))},de=(n,e)=>function(v,y){let t=v[n],V=y[n];if(!V)return-1;if(typeof t=="string"&&typeof V=="string"){const j=t.localeCompare(V,"zh");return e==="ascending"?j:-j}else{if(t<=V)return e==="ascending"?-1:1;if(t>V)return e==="ascending"?1:-1}},ce=()=>({backgroundColor:"#F5F7FA",color:"#909399"}),pe=()=>({color:"#303133"});return(n,e)=>{const v=Y("el-input"),y=Y("el-col");return k(),I(P,null,[l(o(J),{onSubmit:e[4]||(e[4]=q(()=>{},["prevent"])),ref_key:"formRef1",ref:W,model:f,"label-position":"left","label-width":"fit-content",class:"flex w-100%"},{default:a(()=>[l(y,{class:"p-2",span:6},{default:a(()=>[l(o(x),{class:"flex text-center flex-items-center mb-5 pe-3",label:"待辦事項：",prop:"list_name"},{default:a(()=>[l(v,{modelValue:f.list_name,"onUpdate:modelValue":e[0]||(e[0]=t=>f.list_name=t)},null,8,["modelValue"])]),_:1})]),_:1}),l(y,{class:"p-2",span:6},{default:a(()=>[l(o(x),{class:"flex text-center flex-items-center mb-5 pe-3",label:"詳細資訊：",prop:"description"},{default:a(()=>[l(v,{modelValue:f.description,"onUpdate:modelValue":e[1]||(e[1]=t=>f.description=t)},null,8,["modelValue"])]),_:1})]),_:1}),l(y,{class:"p-2",span:6},{default:a(()=>[l(o(x),{class:"flex text-center flex-items-center mb-5 pe-3",label:"是否完成：",prop:"description"},{default:a(()=>[l(o(O),{modelValue:f.done_yn,"onUpdate:modelValue":e[2]||(e[2]=t=>f.done_yn=t),clearable:""},{default:a(()=>[(k(!0),I(P,null,$(h.value,t=>(k(),G(o(H),{key:t.label,value:t.value,label:t.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(y,{class:"p-2",span:4},{default:a(()=>[l(o(b),{onClick:e[3]||(e[3]=()=>{te()})},{default:a(()=>[p(" 搜尋 ")]),_:1})]),_:1})]),_:1},8,["model"]),l(o(b),{class:"ms-2 mb-2",type:"primary",onClick:e[5]||(e[5]=t=>le())},{default:a(()=>[p("新增")]),_:1}),l(o(ve),{"header-cell-style":ce,onSortChange:ie,"cell-style":pe,"empty-text":"查無資料",border:"",class:"mb-4 mt-3",data:ee.value},{default:a(()=>[l(o(L),{prop:"list_name",width:"200px",label:"待辦事項",sortable:""}),l(o(L),{prop:"done_yn",width:"158px",label:"已完成",sortable:""},{default:a(t=>[p(C(t.row.done_yn==="Y"?"已完成":"未完成"),1)]),_:1}),l(o(L),{prop:"description",label:"詳細資訊",sortable:""}),l(o(L),{prop:"update_time",width:"110px",label:"更新時間",sortable:""},{default:a(t=>[p(C(new Date(t.row.update_time).toLocaleDateString()),1)]),_:1}),l(o(L),{fixed:"right",prop:"",width:"158px",label:"操作"},{default:a(t=>[l(o(b),{type:"warning",onClick:()=>{ae(t)}},{default:a(()=>[p("編輯")]),_:2},1032,["onClick"]),l(o(b),{type:"danger",onClick:()=>{oe(t)}},{default:a(()=>[p("刪除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),U("div",xe,[l(o(ye),{"page-size":B.value,"onUpdate:pageSize":e[6]||(e[6]=t=>B.value=t),"current-page":F.value,"onUpdate:currentPage":e[7]||(e[7]=t=>F.value=t),"page-sizes":[5,10,20,30,40,50],background:"","pager-count":11,layout:"total,sizes,prev, pager, next,jumper",total:Z.value},null,8,["page-size","current-page","total"])]),l(o(K),{fullscreen:"",modelValue:m.value,"onUpdate:modelValue":e[14]||(e[14]=t=>m.value=t),"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},{header:a(()=>[U("h3",null,C(s.value),1)]),footer:a(()=>[l(o(b),{type:"",onClick:e[12]||(e[12]=()=>{ne()})},{default:a(()=>[p(" 取消 ")]),_:1}),l(o(b),{type:"primary",onClick:e[13]||(e[13]=()=>{se()})},{default:a(()=>[p(" 確定 ")]),_:1})]),default:a(()=>[l(o(J),{rules:X.value,onSubmit:e[11]||(e[11]=q(()=>{},["prevent"])),ref_key:"formRef2",ref:T,model:i,"label-position":"left","label-width":"fit-content",class:"flex flex-wrap w-100%"},{default:a(()=>[l(y,{class:"p-2",span:12},{default:a(()=>[l(o(x),{class:"flex text-center flex-items-center mb-5 pe-3",label:"待辦事項：",prop:"list_name"},{default:a(()=>[l(v,{modelValue:i.list_name,"onUpdate:modelValue":e[8]||(e[8]=t=>i.list_name=t)},null,8,["modelValue"])]),_:1})]),_:1}),l(y,{class:"p-2",span:12},{default:a(()=>[l(o(x),{class:"flex text-center flex-items-center mb-5 pe-3",label:"詳細資訊：",prop:"description"},{default:a(()=>[l(v,{modelValue:i.description,"onUpdate:modelValue":e[9]||(e[9]=t=>i.description=t)},null,8,["modelValue"])]),_:1})]),_:1}),l(y,{class:"p-2",span:12},{default:a(()=>[l(o(x),{class:"flex text-center flex-items-center mb-5 pe-3",label:"是否完成：",prop:"description"},{default:a(()=>[l(o(O),{modelValue:i.done_yn,"onUpdate:modelValue":e[10]||(e[10]=t=>i.done_yn=t),clearable:""},{default:a(()=>[(k(!0),I(P,null,$(h.value,t=>(k(),G(o(H),{key:t.label,value:t.value,label:t.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"]),l(o(K),{modelValue:u.value,"onUpdate:modelValue":e[17]||(e[17]=t=>u.value=t),"align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},{header:a(()=>[U("h3",null,C(r.value),1)]),footer:a(()=>[l(o(b),{type:"",onClick:e[15]||(e[15]=()=>{ue()})},{default:a(()=>[p(" 取消 ")]),_:1}),l(o(b),{type:Q.value,onClick:e[16]||(e[16]=()=>{re()})},{default:a(()=>[p(" 確定 ")]),_:1},8,["type"])]),default:a(()=>[p(" "+C(A.value)+" ",1)]),_:1},8,["modelValue"])],64)}}});export{Ve as default};
