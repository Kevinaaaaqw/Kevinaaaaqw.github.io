import{i as Z,d as G,g as p,l as H,k as J,c as h,b as l,w as t,u as e,r as L,bc as Q,o as f,I as A,s as R,bY as j,bZ as g,n as I,bR as $,p as W,v as M,x as C,f as i,m as X,y as ee,z as b,t as y,ac as B,a as x,A as le,B as z,C as te,b_ as ae,b$ as k,c0 as se,c1 as oe,j as T}from"./index-Ci5yqLQa.js";import{u as ne,t as U,z as re}from"./index-DOnwl_eH.js";const ie=(N,D)=>({movieSearch:async r=>{const o=r.type?`&type=${r.type}`:"",n=r.page?`&page=${r.page}`:"",c=r.y?`&y=${r.y}`:"",_=N+D+`/?s=${r.title}&apikey=a9ad8207${n}${o}${c}`;return await Z.get(_)}}),ue="https://www.omdbapi.com",ce="",de=ie(ue,ce),pe={class:"container mb-50px"},me=["src"],ve={class:"p-1 box-border w-full flex gap-2 flex-wrap justify-center items-center"},fe={class:"w-full flex flex-justify-center mt-2"},ge=x("h3",{class:"text-4xl"}," 詳細資料 ",-1),xe={class:"w-full max-sm-mt-10"},be={class:"w-full flex justify-center"},ye=["src"],he=G({__name:"search",setup(N){const{movieSearch:D}=de,m=p(!1),E=p(),r=H({title:[{required:!0,message:"必須輸入名稱",trigger:"blur"}]}),o=p({title:""}),n=p({title:"",page:1}),c=p({Search:[],totalResults:"0",Response:""}),_=J(()=>Math.ceil(parseInt(c.value.totalResults??0)/10)),P=async()=>{m.value=!0,await D({...n.value}).then(async u=>{c.value=u.data}),m.value=!1},F=u=>{d.value={...u}},w=p(!1),d=p({Title:"",Year:"",imdbID:"",Type:"",Poster:""}),{addMovie:Y}=ne(),K=u=>{const a=Y(u),v={duration:5e3,position:"bottom-right"};switch(a.status){case"failure":a.reason==="NoDataProvided"?T({title:"錯誤",message:"沒有添加檔案",type:"error",...v}):a.reason==="DataAlreadyExists"&&T({title:"錯誤",message:"該項目已在清單中",type:"error",...v});break;case"success":a.message==="AddSuccess"&&T({title:"成功",message:"加入清單成功",type:"success",...v});break}},V=()=>{E.value.validate(u=>{u&&(n.value={...n.value,...o.value,page:1},o.value.title.trim()&&P())})},q=()=>({backgroundColor:"#F5F7FA",color:"#909399"}),O=()=>({color:"#303133",textAlign:"center"});return(u,a)=>{const v=L("el-input"),S=Q("loading");return f(),h("div",pe,[l(e(oe),{locale:e(re)},{default:t(()=>[A((f(),R(e(ee),{onSubmit:a[4]||(a[4]=X(()=>{},["prevent"])),ref_key:"searchMovieRef",ref:E,model:o.value,"label-position":"right","label-width":"auto",class:"flex w-100%",rules:r},{default:t(()=>[l(e(j),{class:"w-full"},{default:t(()=>[l(e(g),{class:"p-2",xs:24,sm:12,md:8,lg:8,xl:8},{default:t(()=>[l(e(I),{class:"flex text-center flex-items-center mb-5 pe-3",label:"電影名稱：",prop:"title"},{default:t(()=>[l(v,{modelValue:o.value.title,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value.title=s),onKeydown:$(V,["enter"])},null,8,["modelValue"])]),_:1})]),_:1}),l(e(g),{class:"p-2",xs:24,sm:6,md:8,lg:8,xl:8},{default:t(()=>[l(e(I),{class:"flex text-center flex-items-center mb-5 pe-3",label:"類型：",prop:"type"},{default:t(()=>[l(e(W),{modelValue:o.value.type,"onUpdate:modelValue":a[1]||(a[1]=s=>o.value.type=s),clearable:""},{default:t(()=>[l(e(M),{value:"movie",label:"電影"}),l(e(M),{value:"series",label:"連續劇"}),l(e(M),{value:"episode",label:"劇集"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(e(g),{class:"p-2",xs:24,sm:6,md:8,lg:8,xl:8},{default:t(()=>[l(e(I),{class:"flex text-center flex-items-center mb-5 pe-3",label:"發行年份：",prop:"y"},{default:t(()=>[l(v,{modelValue:o.value.y,"onUpdate:modelValue":a[2]||(a[2]=s=>o.value.y=s),onKeydown:$(V,["enter"])},null,8,["modelValue"])]),_:1})]),_:1}),l(e(g),{class:"p-2",span:6},{default:t(()=>[l(e(C),{type:"primary",onClick:a[3]||(a[3]=()=>{V()})},{default:t(()=>[i(" 搜尋電影 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[S,m.value]]),A((f(),R(e(le),{"header-cell-style":q,"cell-style":O,"empty-text":"查無資料",border:"",class:"mb-4 mt-3",data:c.value.Search??[]},{default:t(()=>[l(e(b),{align:"center",prop:"Year",label:"發行年份"}),l(e(b),{align:"center",prop:"Title",label:"電影名稱"}),l(e(b),{align:"center",prop:"Type",width:"100px",label:"類型"},{default:t(s=>[i(y(e(U)(s.row.Type)),1)]),_:1}),l(e(b),{align:"center","min-width":"100px",label:"圖片"},{default:t(s=>[s.row.Poster!="N/A"?(f(),h("img",{key:0,class:"w-full object-contain max-h-200px",src:s.row.Poster,alt:"電影圖片"},null,8,me)):B("",!0)]),_:1}),l(e(b),{align:"center","min-width":"120px",fixed:"right",prop:"",label:"操作"},{default:t(s=>[x("div",ve,[x("div",null,[l(e(C),{type:"warning",onClick:()=>{K(s.row)}},{default:t(()=>[i("加入蒐藏")]),_:2},1032,["onClick"])]),x("div",null,[l(e(C),{type:"success",onClick:()=>{F(s.row),w.value=!0}},{default:t(()=>[i("查看")]),_:2},1032,["onClick"])])])]),_:1})]),_:1},8,["data"])),[[S,m.value]]),A((f(),h("div",fe,[l(e(z),{class:"max-md-hidden",background:"","current-page":n.value.page,"onUpdate:currentPage":a[5]||(a[5]=s=>n.value.page=s),"page-size":10,total:parseInt(c.value.totalResults??0),"pager-count":7,"page-count":_.value,layout:"prev, pager, next, jumper, total",onCurrentChange:a[6]||(a[6]=s=>{n.value.page=s,P()})},null,8,["current-page","total","page-count"]),l(e(z),{size:"small",class:"md-hidden","current-page":n.value.page,"onUpdate:currentPage":a[7]||(a[7]=s=>n.value.page=s),"page-size":10,total:parseInt(c.value.totalResults??0),"pager-count":5,"page-count":_.value,layout:"prev, pager, next, jumper",onCurrentChange:a[8]||(a[8]=s=>{n.value.page=s,P()})},null,8,["current-page","total","page-count"])])),[[S,m.value]]),l(e(te),{fullscreen:"",modelValue:w.value,"onUpdate:modelValue":a[10]||(a[10]=s=>w.value=s)},{header:t(()=>[ge]),footer:t(()=>[l(e(C),{type:"",onClick:a[9]||(a[9]=()=>{w.value=!1})},{default:t(()=>[i(" 離開 ")]),_:1})]),default:t(()=>[l(e(j),{class:"w-full flex-wrap-reverse"},{default:t(()=>[l(e(g),{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[x("div",xe,[l(e(ae),{column:1},{default:t(()=>[l(e(k),{label:"電影名稱：","label-class-name":"md-text-2xl","class-name":"md-text-2xl"},{default:t(()=>[i(y(d.value.Title),1)]),_:1}),l(e(k),{label:"發行年分：","label-class-name":"md-text-2xl","class-name":"md-text-2xl"},{default:t(()=>[i(y(d.value.Year),1)]),_:1}),l(e(k),{label:"類型：","label-class-name":"md-text-2xl","class-name":"md-text-2xl"},{default:t(()=>[i(y(e(U)(d.value.Type)),1)]),_:1}),l(e(k),{label:"imdbID：","label-class-name":"md-text-2xl","class-name":"md-text-2xl"},{default:t(()=>[i(y(d.value.imdbID),1)]),_:1})]),_:1})])]),_:1}),l(e(g),{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[x("div",be,[d.value.Poster!="N/A"?(f(),h("img",{key:0,class:"w-full object-contain max-w500px",src:d.value.Poster,alt:"電影圖片"},null,8,ye)):B("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(e(se),{class:"bg-bg-1 max-md-hidden",right:50,bottom:50})]),_:1},8,["locale"])])}}});export{he as default};
